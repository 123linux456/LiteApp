!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t["api-app"]=t["api-app"]||{},t["api-app"].thread=n())}(this,function(){"use strict";function t(t,n){console.log("[api triggerEvent] : "+t+" , "+JSON.stringify(n)),__base__.triggerEvent(t,n,function(t){})}function n(t,n){var e=[],o=t;for(var r in n)n.hasOwnProperty(r)&&e.push(r+"="+encodeURIComponent(n[r]));return e.length>0&&(o+=-1==o.indexOf("?")?"?":"&",o+=e.join("&")),o}function e(t){return void 0!==t&&null!==t}function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(){for(var t=0;t<P.length;t++)P[t][0](P[t][1]);P=[],d=!1}function a(t,n){P.push([t,n]),d||(d=!0,O(r,0))}function i(t){var n=t.owner,e=n.state_,o=n.data_,r=t[e],a=t.then;if("function"==typeof r){e=E;try{o=r(o)}catch(t){f(a,t)}}c(a,o)||(e===E&&u(a,o),e===j&&f(a,o))}function c(t,n){var e;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(o){e||(e=!0,n!==o?u(t,o):s(t,o))},function(n){e||(e=!0,f(t,n))}),!0}}catch(n){return e||f(t,n),!0}return!1}function u(t,n){t!==n&&c(t,n)||s(t,n)}function s(t,n){t.state_===m&&(t.state_=b,t.data_=n,a(p,t))}function f(t,n){t.state_===m&&(t.state_=b,t.data_=n,a(h,t))}function l(t){var n=t.then_;t.then_=void 0;for(var e=0;e<n.length;e++)i(n[e])}function p(t){t.state_=E,l(t)}function h(t){t.state_=j,l(t)}function _(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof _==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,n){function e(t){f(n,t)}try{t(function(t){u(n,t)},e)}catch(t){e(t)}}(t,this)}var d,g="undefined"==typeof window&&"undefined"!=typeof global&&void 0!==global.__base__?global:window,w="http://10.127.18.211:8003",y=_,v=y&&"resolve"in y&&"reject"in y&&"all"in y&&"race"in y&&function(){var t;return new y(function(n){t=n}),"function"==typeof t}(),m="pending",b="sealed",E="fulfilled",j="rejected",S=function(){},O="undefined"!=typeof setImmediate?setImmediate:setTimeout,P=[];_.prototype={constructor:_,state_:m,then_:null,data_:void 0,then:function(t,n){var e={owner:this,then:new this.constructor(S),fulfilled:t,rejected:n};return this.state_===E||this.state_===j?a(i,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},_.all=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(n,e){function o(t){return i++,function(e){a[t]=e,--i||n(a)}}for(var r,a=[],i=0,c=0;c<t.length;c++)(r=t[c])&&"function"==typeof r.then?r.then(o(c),e):a[c]=r;i||n(a)})},_.race=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(n,e){for(var o,r=0;r<t.length;r++)(o=t[r])&&"function"==typeof o.then?o.then(n,e):n(o)})},_.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(n){n(t)})},_.reject=function(t){return new this(function(n,e){e(t)})};var k=v?y:_,A=function(){},T={method:"GET",success:A,fail:A,complete:A},C={show:function(t){var n=__thread__.callback.saveCallback(t.yes),e=__thread__.callback.saveCallback(t.no);__thread__.api.webviewCall("confirm.show",{content:t.content,buttons:t.buttons,yes:n,no:e})}},J={show:function(n){console.log("loadingShow"),t("loading",{action:"show"})},hide:function(n){console.log("loadingHide"),t("loading",{action:"hide"})}},N={show:function(t){__thread__.api.webviewCall("toast.show",t)}},B={},D=Object.freeze({baseCall:t,share:function(e,o){t("share",{url:n(w+"/123/web/src/_html/"+e+".html",o)})},goBrowser:function(e,o){t("goBrowser",{url:n(w+"/123/web/src/_html/"+e+".html",o)})},getAppData:function(){if("undefined"!=typeof __app__data)return console.log("[thread api getAppData]"+JSON.stringify(__app__data)),__app__data;throw new Error("[thread api getAppData] no __app__data")},request:function(t){function o(o,r){"GET"==t.method&&e(t.params)&&(t.url=n(t.url,t.params)),console.log("network start : "+t.url),console.log("request start"),network.get(t.url,t,o,r)}return void 0===t&&(t=T),t.success?o(function(n){t.success(JSON.parse(n))},function(n){t.fail(JSON.parse(n))}):new k(o).then(function(t){return t?JSON.parse(t):{}})},goPage:function(n,e){var o={path:n,data:e};console.log("[api goPage] : "+JSON.stringify(o)),t("goPage",o)},getPageData:function(){return console.log("[api getPagedata] : "+__page__data),__page__data},setSwipeRefresh:function(n){console.log("[api setSwipeRefresh] : "+JSON.stringify(n)),t("setSwipeRefresh",n)},confirm:C,loading:J,toast:N,addBodyEvent:function(t,n){(B[t]=B[t]||[]).push(n),__thread__.api.webviewCall("addBodyEvent",t)},triggerBodyEvent:function(t){Array.isArray(B[t])&&B[t].forEach(function(t){e(t)&&t.call(null)})},login:function(n){void 0===n&&(n={success:function(){},error:function(){}}),t("login",n)}});return g.__api__=g.qiyiApi=D,D});