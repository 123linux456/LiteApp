!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(require("whatwg-fetch")):"function"==typeof define&&define.amd?define(["whatwg-fetch"],n):n()}(0,function(){"use strict";function t(t,n){console.log("[api triggerEvent] : "+t+" , "+JSON.stringify(n)),function(t,n){switch(t){case"webopen":location.href=n.url;break;case"dialog":g.init(n)}}.apply(void 0,arguments)}function n(t,n){var e=[],o=t;for(var i in n)n.hasOwnProperty(i)&&e.push(i+"="+encodeURIComponent(n[i]));return e.length>0&&(o+=-1==o.indexOf("?")?"?":"&",o+=e.join("&")),o}function e(t){return void 0!==t&&null!==t}function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(){for(var t=0;t<I.length;t++)I[t][0](I[t][1]);I=[],v=!1}function r(t,n){I.push([t,n]),v||(v=!0,S(i,0))}function a(t){var n=t.owner,e=n.state_,o=n.data_,i=t[e],r=t.then;if("function"==typeof i){e=k;try{o=i(o)}catch(t){d(r,t)}}c(r,o)||(e===k&&l(r,o),e===j&&d(r,o))}function c(t,n){var e;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(o){e||(e=!0,n!==o?l(t,o):s(t,o))},function(n){e||(e=!0,d(t,n))}),!0}}catch(n){return e||d(t,n),!0}return!1}function l(t,n){t!==n&&c(t,n)||s(t,n)}function s(t,n){t.state_===C&&(t.state_=x,t.data_=n,r(f,t))}function d(t,n){t.state_===C&&(t.state_=x,t.data_=n,r(p,t))}function u(t){var n=t.then_;t.then_=void 0;for(var e=0;e<n.length;e++)a(n[e])}function f(t){t.state_=k,u(t)}function p(t){t.state_=j,u(t)}function h(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof h==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,n){function e(t){d(n,t)}try{t(function(t){l(n,t)},e)}catch(t){e(t)}}(t,this)}var g={dom:null,init:function(t){var n=this,e=t.title,o=t.content,i=t.left_button,r=t.right_button,a=t.dialog_left_button_click,c=t.dialog_right_button_click,l='\n            <div class="gpad_dialog">\n                <header class="gpad_dialog_title">'+e+'</header>\n                <div class="gpad_dialog_content">'+o+'</div>\n                <div class="gpad_dialog_btn-wrap">\n                    '+(i?'<div class="gpad_dialog_btn" id="gpad_dialog_left_btn">'+i+"</div>":"")+"\n                    "+(r?'<div class="gpad_dialog_btn" id="gpad_dialog_right_btn">'+r+"</div>":"")+"\n                </div>\n            </div>\n        ",s=document.createElement("div");s.innerHTML=l+"\n            <style>\n                .gpad_dialog{ position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:black;color:white; text-align:center;min-width:200px;}\n                .gpad_dialog_title{font-size:18px;padding:10px;}\n                .gpad_dialog_content{font-size:14px;padding:10px;text-align:left;}\n                .gpad_dialog_btn-wrap{margin-top:20px;display:flex;}\n                .gpad_dialog_btn{flex:1;border:1px solid red;padding:10px 0;}\n            </style>\n        ",s.addEventListener("click",function(t){"gpad_dialog_left_btn"==t.target.id&&(a?a():n.hide()),"gpad_dialog_right_btn"==t.target.id&&(c?c():n.hide())}),this.dom=s,this.show()},show:function(){document.body.appendChild(this.dom)},hide:function(){document.body.removeChild(this.dom)}},_="undefined"==typeof window&&"undefined"!=typeof global&&void 0!==global.__base__?global:window,w="http://10.127.18.211:8003";!function(t){var n=!1;if("function"==typeof define&&define.amd&&(define(t),n=!0),"object"==typeof exports&&(module.exports=t(),n=!0),!n){var e=window.Cookies,o=window.Cookies=t();o.noConflict=function(){return window.Cookies=e,o}}}(function(){function t(){for(var t=arguments,n=0,e={};n<arguments.length;n++){var o=t[n];for(var i in o)e[i]=o[i]}return e}function n(e){function o(n,i,r){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(r=t({path:"/"},o.defaults,r)).expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*r.expires),r.expires=c}r.expires=r.expires?r.expires.toUTCString():"";try{a=JSON.stringify(i),/^[\{\[]/.test(a)&&(i=a)}catch(t){}i=e.write?e.write(i,n):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var l="";for(var s in r)r[s]&&(l+="; "+s,!0!==r[s]&&(l+="="+r[s]));return document.cookie=n+"="+i+l}n||(a={});for(var d=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,f=0;f<d.length;f++){var p=d[f].split("="),h=p.slice(1).join("=");this.json||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var g=p[0].replace(u,decodeURIComponent);if(h=e.read?e.read(h,g):e(h,g)||h.replace(u,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(t){}if(n===g){a=h;break}n||(a[g]=h)}catch(t){}}return a}}return o.set=o,o.get=function(t){return o.call(o,t)},o.getJSON=function(){return o.apply({json:!0},[].slice.call(arguments))},o.defaults={},o.remove=function(n,e){o(n,"",t(e,{expires:-1}))},o.withConverter=n,o}return n(function(){})});var v,m=window.Cookies,b=h,y=b&&"resolve"in b&&"reject"in b&&"all"in b&&"race"in b&&function(){var t;return new b(function(n){t=n}),"function"==typeof t}(),C="pending",x="sealed",k="fulfilled",j="rejected",E=function(){},S="undefined"!=typeof setImmediate?setImmediate:setTimeout,I=[];h.prototype={constructor:h,state_:C,then_:null,data_:void 0,then:function(t,n){var e={owner:this,then:new this.constructor(E),fulfilled:t,rejected:n};return this.state_===k||this.state_===j?r(a,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},h.all=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(n,e){function o(t){return a++,function(e){r[t]=e,--a||n(r)}}for(var i,r=[],a=0,c=0;c<t.length;c++)(i=t[c])&&"function"==typeof i.then?i.then(o(c),e):r[c]=i;a||n(r)})},h.race=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(n,e){for(var o,i=0;i<t.length;i++)(o=t[i])&&"function"==typeof o.then?o.then(n,e):n(o)})},h.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(n){n(t)})},h.reject=function(t){return new this(function(n,e){e(t)})};var P=y?b:h,R=function(){},O={method:"GET",success:R,fail:R,complete:R},T={show:function(t){var n=__thread__.callback.saveCallback(t.yes),e=__thread__.callback.saveCallback(t.no);__thread__.api.webviewCall("confirm.show",{content:t.content,buttons:t.buttons,yes:n,no:e})}},U={show:function(t){console.log("loadingShow"),__thread__.api.webviewCall("loading.show",t)},hide:function(t){console.log("loadingHide"),__thread__.api.webviewCall("loading.hide",t)}},A={show:function(t){__thread__.api.webviewCall("toast.show",t)}},B={scrollEnd:{add:function(t){window.addEventListener("scroll",function(){document.body.scrollHeight-window.scrollY<window.screen.availHeight+100&&e(t)&&t.call(null)})}}},D=Object.freeze({baseCall:t,share:function(t,e){var o=n(w+"/123/web/src/_html/"+t+".html",e);this.baseCall("share",{url:o})},goBrowser:function(t,e){var o=n(w+"/123/web/src/_html/"+t+".html",e);this.baseCall("goBrowser",{url:o})},getAppData:function(){return console.log("[api getAppData]"),{userId:m.get("P00003"),agentversion:"h5",authCookie:m.get("P00001")}},request:function(t){function o(o,i){return"GET"==t.method&&e(t.params)&&(t.url=n(t.url,t.params)),fetch(t.url,t).then(function(t){return console.log(t),function(t){return t.text().then(function(t){return t?JSON.parse(t):{}})}(t)}).then(function(t){o&&o.call(null,t)}).catch(function(t){console.log(t),i&&i.call(null,t)})}return void 0===t&&(t=O),t.success?o(t.success,t.fail):new P(o)},goPage:function(t,e){var o=window.location.pathname.split(/\//);o[o.length-2]=t;var i=o.join("/");window.location.href=n(i,e)},getPageData:function(){var t={};return t=function(){var t,n,e=window.location.search.substring(1).split("&"),o={};for(n in e)""!==e[n]&&(t=e[n].split("="),o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]));return o}(),console.log("[api getPagedata] : "+t),t},setSwipeRefresh:function(t){console.log("[api setSwipeRefresh] : "+JSON.stringify(t))},confirm:T,loading:U,toast:A,addBodyEvent:function(t,n){B[t].add(n)},login:function(n){void 0===n&&(n={success:function(){},error:function(){}}),t("login",n)}});_.__api__=_.qiyiApi=D});